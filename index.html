<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sinuca Gold â€“ Tiro Livre</title>

<style>
body{
    margin:0;
    background: radial-gradient(circle,#111,#000);
    font-family: Arial Black, sans-serif;
    color: gold;
    display:flex;
    flex-direction:column;
    align-items:center;
    height:100vh;
    overflow:hidden;
}

header{
    margin-top:12px;
    text-align:center;
    text-shadow:0 0 10px gold;
}

#saldo{font-size:26px;}
#apostaBox{
    margin-top:8px;
    font-size:16px;
}
input{
    width:80px;
    text-align:center;
    font-size:16px;
}

canvas{
    background: linear-gradient(135deg,#0b5e28,#043314);
    border:10px solid #3e2723;
    border-radius:20px;
    margin-top:15px;
    box-shadow:0 0 30px rgba(0,0,0,.8);
}

#forca{
    width:80%;
    height:16px;
    background:#222;
    border:2px solid gold;
    border-radius:10px;
    margin-top:12px;
    overflow:hidden;
}
#forcaFill{
    height:100%;
    width:0%;
    background:linear-gradient(90deg,#ff0,#f00);
}

#msg{
    position:absolute;
    top:50%;
    transform:translateY(-50%);
    font-size:48px;
    display:none;
    text-shadow:0 0 20px gold;
}
</style>
</head>

<body>

<header>
    <div>Saldo: R$ <span id="saldo">100.00</span></div>
    <div id="apostaBox">
        Aposta: R$ <input id="aposta" type="number" value="10" min="1">
    </div>
</header>

<canvas id="game"></canvas>

<div id="forca"><div id="forcaFill"></div></div>

<div id="msg">GANHOU ðŸ’°</div>

<script>
/* ========= CONFIG ========= */
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
canvas.width = window.innerWidth * 0.9;
canvas.height = canvas.width * 0.55;

let saldo = 100;
let charging = false;
let power = 0;

/* ========= SONS ========= */
const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

function playSound(freq, time){
    const osc = audioCtx.createOscillator();
    const gain = audioCtx.createGain();
    osc.frequency.value = freq;
    osc.connect(gain);
    gain.connect(audioCtx.destination);
    gain.gain.setValueAtTime(0.2, audioCtx.currentTime);
    gain.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + time);
    osc.start();
    osc.stop(audioCtx.currentTime + time);
}

/* ========= BOLAS ========= */
// Bola branca (taco)
const white = { x: canvas.width*0.25, y: canvas.height/2, vx:0, vy:0, r:12 };

// BolÃ£o (alvo)
const big = { x: canvas.width*0.7, y: canvas.height/2, vx:0, vy:0, r:20 };

// CaÃ§apa
const pocket = { x: canvas.width*0.9, y: canvas.height/2, r:26 };

function drawBall(b,color){
    ctx.fillStyle=color;
    ctx.beginPath();
    ctx.arc(b.x,b.y,b.r,0,Math.PI*2);
    ctx.fill();
}

function physics(b){
    b.x += b.vx;
    b.y += b.vy;
    b.vx *= 0.97;
    b.vy *= 0.97;
}

function collide(a,b){
    const dx = b.x - a.x;
    const dy = b.y - a.y;
    const dist = Math.hypot(dx,dy);
    if(dist < a.r + b.r){
        const angle = Math.atan2(dy,dx);
        const speed = Math.hypot(a.vx,a.vy);

        b.vx = Math.cos(angle)*speed;
        b.vy = Math.sin(angle)*speed;
        a.vx *= 0.3;
        a.vy *= 0.3;

        playSound(200,0.08); // som colisÃ£o
    }
}

function draw(){
    ctx.clearRect(0,0,canvas.width,canvas.height);

    // CaÃ§apa
    ctx.fillStyle="#000";
    ctx.beginPath();
    ctx.arc(pocket.x,pocket.y,pocket.r,0,Math.PI*2);
    ctx.fill();

    drawBall(white,"#fff");
    drawBall(big,"#f44336");

    physics(white);
    physics(big);
    collide(white,big);

    // VitÃ³ria (bolÃ£o na caÃ§apa)
    if(Math.hypot(big.x-pocket.x,big.y-pocket.y) < pocket.r){
        const aposta = Number(document.getElementById("aposta").value);
        saldo += aposta * 2;
        document.getElementById("saldo").innerText = saldo.toFixed(2);

        playSound(800,0.2);
        document.getElementById("msg").style.display="block";

        setTimeout(()=>document.getElementById("msg").style.display="none",1500);

        big.x = canvas.width*0.7;
        big.y = canvas.height/2;
        big.vx = big.vy = 0;
    }

    requestAnimationFrame(draw);
}

/* ========= CONTROLES ========= */
canvas.addEventListener("touchstart", ()=>{
    if(Math.abs(white.vx)<0.1){
        charging=true;
        power=0;
    }
});

canvas.addEventListener("touchend", ()=>{
    if(!charging) return;
    charging=false;

    const aposta = Number(document.getElementById("aposta").value);
    if(saldo < aposta) return;

    saldo -= aposta;
    document.getElementById("saldo").innerText = saldo.toFixed(2);

    white.vx = power/4;
    white.vy = (Math.random()-0.5)*2;
    document.getElementById("forcaFill").style.width="0%";

    playSound(120,0.1); // som tacada
});

setInterval(()=>{
    if(charging){
        power = Math.min(power+2,100);
        document.getElementById("forcaFill").style.width=power+"%";
    }
},30);

draw();
</script>

</body>
</html>
